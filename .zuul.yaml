- job:
    name: nodepool-functional-base
    parent: devstack
    pre-run: playbooks/nodepool-functional-base/pre.yaml
    post-run: playbooks/nodepool-functional-base/post.yaml
    timeout: 5400
    required-projects:
      - openstack-infra/nodepool
    vars:
      devstack_services:
        horizon: false
        ceilometer-acentral: false
        ceilometer-acompute: false
        ceilometer-alarm-evaluator: false
        ceilometer-alarm-notifier: false
        ceilometer-anotification: false
        ceilometer-api: false
        ceilometer-collector: false
        cinder: false
        c-bak: false
        c-sch: false
        c-api: false
        c-vol: false
        s-account: false
        s-container: false
        s-object: false
        s-proxy: false
      devstack_plugins:
        nodepool: https://git.openstack.org/openstack-infra/nodepool

- job:
    name: nodepool-functional-py35
    parent: nodepool-functional-base
    description: |
      Run nodepool functional tests for py35
    run: playbooks/nodepool-functional-py35/run.yaml

- job:
    name: nodepool-functional-py35-src
    parent: nodepool-functional-base
    run: playbooks/nodepool-functional-py35-src/run.yaml
    vars:
      devstack_localrc:
        LIBS_FROM_GIT: shade,glean,diskimage-builder
    required-projects:
      - openstack-infra/glean
      - openstack-infra/nodepool
      - openstack-infra/shade
      - openstack/diskimage-builder

- job:
    name: nodepool-zuul-functional
    parent: legacy-base
    run: playbooks/nodepool-zuul-functional/run.yaml
    post-run: playbooks/nodepool-zuul-functional/post.yaml
    timeout: 1800
    required-projects:
      - openstack-infra/nodepool
      - openstack-infra/zuul

- project:
    check:
      jobs:
        - tox-docs
        - tox-cover
        - tox-pep8
        - tox-py35
        - nodepool-functional-py35:
            voting: false
        - nodepool-functional-py35-src:
            voting: false
    gate:
      jobs:
        - tox-pep8
        - tox-py35
    experimental:
      jobs:
        - nodepool-zuul-functional
