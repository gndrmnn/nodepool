- hosts: cluster
  roles:
    - deploy-openshift

- hosts: launcher
  pre_tasks:
    - name: Login to the openshift cluster as developer
      command: >
          oc login -u developer -p developer --insecure-skip-tls-verify=true
          https://{{ hostvars['cluster']['ansible_host'] }}:8443

    - name: Get context name
      shell: oc config get-contexts | awk '/myproject/ { print $2}'
      register: context_name
  roles:
    - role: tox
      tox_envlist: functional_openshift
