{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3030d2db_bed96a58",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 28619
      },
      "writtenOn": "2022-05-23T07:39:02Z",
      "side": 1,
      "message": "I think unit test should be also fixed here, as it seems it\u0027s missing that assertion. I guess that\u0027s the proper one that should contain check https://opendev.org/zuul/nodepool/src/branch/master/nodepool/tests/unit/test_builder.py#L172",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e31ec619_e00fea83",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 28619
      },
      "writtenOn": "2022-05-23T07:40:26Z",
      "side": 1,
      "message": "Oh, sorry, I\u0027m wrong. Just another test should be written, like `test_post_upload_hook_failure`, as only positive test is present (https://opendev.org/zuul/nodepool/src/branch/master/nodepool/tests/unit/test_builder.py#L560)",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dd1eb79e_30dd1d1f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 4146
      },
      "writtenOn": "2022-05-23T15:33:25Z",
      "side": 1,
      "message": "I agree that a test would be helpful. But I don\u0027t think there is a mismatch of interfaces here.",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "50bf42c4_8653c39a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 32053
      },
      "writtenOn": "2022-05-24T13:54:10Z",
      "side": 1,
      "message": "I tried to write a test, but faced the following problem:\nNodepool skips failures and retry image building and uploading continuously. And this can\u0027t be tracked trough zookeeper as failed image marked failed. There is no way to check that typeerror was raised during image upload. And there is no way to get a list of images from fake provider to compare them during builder run. At lease I haven\u0027t found how.",
      "parentUuid": "e31ec619_e00fea83",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb48e40c_f30131fe",
        "filename": "nodepool/builder.py",
        "patchSetId": 1
      },
      "lineNbr": 1128,
      "author": {
        "id": 28619
      },
      "writtenOn": "2022-05-23T10:46:09Z",
      "side": 1,
      "message": "Also are you sure that this should be patched instead of patching https://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/openstack/provider.py#L216 to require only uuid and get name by it?\n\nAt this point it feels like providers are not in sync about amount of arguments to accept. And it also feels, like accepting single argument would be more correct, but not sure.",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5c0b61e_ac9c2dfa",
        "filename": "nodepool/builder.py",
        "patchSetId": 1
      },
      "lineNbr": 1128,
      "author": {
        "id": 4146
      },
      "writtenOn": "2022-05-23T15:33:25Z",
      "side": 1,
      "message": "I don\u0027t think this code was ever correct. This should call into https://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/statemachine.py#L667 for all of the drivers which has the same signature whether aws or openstack or azure.",
      "parentUuid": "fb48e40c_f30131fe",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b303390_6880fc89",
        "filename": "nodepool/builder.py",
        "patchSetId": 1
      },
      "lineNbr": 1128,
      "author": {
        "id": 34932
      },
      "writtenOn": "2022-05-30T07:59:44Z",
      "side": 1,
      "message": "It definetely will keep failing with TypeError at least because following methods in AWS, Azure and IBM VPC drivers accept only one parameter:\n\nhttps://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/azure/adapter.py#L479\n\nhttps://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/aws/adapter.py#L343\n\nhttps://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/ibmvpc/adapter.py#L523\n\nI learned sources for a while and found an interface-class for adapters (https://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/statemachine.py#L808) with same named method `deleteImage(external_id)` taking exactly one parameter.\nThough provider for OpenStack (https://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/openstack/provider.py#L40) doesn\u0027t inherit that class excplicitly, they both have a common methods supposed to provide the same functionality and probably might have same signatures (`deleteImage()`, `uploadImage()`). \n\nSo i would propose getting rid from `name` parameter in the following lines:\nhttps://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/openstack/provider.py#L216\nhttps://opendev.org/zuul/nodepool/src/branch/master/nodepool/driver/statemachine.py#L667\nas Dmitriy suggested above. As a quick fix. \n\nFurther maybe there will be good to see reimplementing of base classes for all drivers to enhance uniformity of interfaces.",
      "revId": "64cdd177bde3b16f294966a566d14684168a8c5d",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    }
  ]
}