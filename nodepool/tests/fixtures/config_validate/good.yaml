elements-dir: /etc/nodepool/elements
images-dir: /opt/nodepool_dib

webapp:
  port: 8005
  listen_address: '0.0.0.0'

zookeeper-servers:
  - host: zk1.openstack.org
    port: 2181
    chroot: /test

labels:
  - name: trusty
    max-ready-age: 3600
    min-ready: 1
  - name: trusty-2-node
    min-ready: 0
  - name: trusty-external
    min-ready: 1
  - name: trusty-static
  - name: fedora-oci
  - name: centos-oci
  - name: centos-pod

providers:
  - name: cloud1
    driver: openstack
    cloud: vanilla-cloud
    region-name: 'vanilla'
    boot-timeout: 120
    max-concurrency: 10
    launch-retries: 3
    rate: 0.001
    diskimages:
      - name: trusty
    pools:
      - name: main
        max-servers: 184
        auto-floating-ip: True
        labels:
          - name: trusty
            diskimage: trusty
            min-ram: 8192
            console-log: True
          - name: trusty-2-node
            diskimage: trusty
            min-ram: 8192
            boot-from-volume: True
            volume-size: 100

  - name: cloud2
    driver: openstack
    cloud: chocolate-cloud
    region-name: 'chocolate'
    boot-timeout: 120
    rate: 0.001
    diskimages:
      - name: trusty
        pause: False
        connection-type: ssh
    cloud-images:
      - name: trusty-unmanaged
        config-drive: true
      - name: windows-unmanaged
        username: winzuul
        connection-type: winrm
    pools:
      - name: main
        max-servers: 184
        auto-floating-ip: False
        labels:
          - name: trusty
            diskimage: trusty
            min-ram: 8192
          - name: trusty-2-node
            diskimage: trusty
            min-ram: 8192
          - name: trusty-external
            cloud-image: trusty-unmanaged
            min-ram: 8192

  - name: static-rack
    driver: static
    pools:
      - name: main
        nodes:
          - name: trusty.example.com
            labels: trusty-static
            host-key: fake-key
            timeout: 13
            ssh-port: 22022
            username: zuul
            max-parallel-jobs: 1

  - name: runc
    driver: oci
    hypervisor: fedora.example.com
    pools:
      - name: main
        max-servers: 42
        labels:
          - name: fedora-oci
          - name: centos-oci
            path: /srv/centos

  - name: openshift
    driver: k8s
    apiserver-url: https://openshift.example.com:8080
    zuul-public-key: ssh-rsa AAAA8Fake
    pools:
      - name: main
        namespace: default
        max-servers: 42
        labels:
          - name: centos-pod
            image: docker.io/softwarefactoryproject/zuul-worker-centos-7

  - name: ec2-us-east-2
    driver: aws
    region: us-east-2
    zuul-public-key: ssh-rsa AAAA8Fake
    pools:
      - name: main
        max-servers: 42
        labels:
          - name: centos-ami
            ami: ami-cfdafaaa
            flavor-name: t2.micro

diskimages:
  - name: trusty
    formats:
      - tar
    pause: False
    elements:
      - ubuntu
      - vm
      - openstack-repos
      - puppet
      - nodepool-base
      - cache-devstack
    release: trusty
    rebuild-age: 3600
    env-vars:
      TMPDIR: /opt/dib_tmp
      DIB_IMAGE_CACHE: /opt/dib_cache
      QEMU_IMG_OPTIONS: compat=0.10
